FROM ubi9

# Set working directory
WORKDIR /app

# Install system dependencies
RUN dnf install -y python3-pip mesa-libGL

# Install Python dependencies
RUN pip install docling fastapi uvicorn --extra-index-url https://download.pytorch.org/whl/cpu

# Copy the server script
COPY server.py /app/server.py

# Create workspace directory
RUN mkdir -p /workspace

# Set environment variables
ENV DOCLING_WORKSPACE=/workspace
ENV PORT=8000

# Expose the port
EXPOSE 8000

# Run the server
CMD ["python3", "/app/server.py"]
